<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Calendar Widget</title>

  <!-- Jotform Custom Widget API -->
  <script src="https://js.jotform.com/JotFormCustomWidget.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 12px;
    }
    .slot {
      margin: 6px 0;
      padding: 8px;
      border: 1px solid #ccc;
      cursor: pointer;
      border-radius: 4px;
    }
    .slot:hover {
      background: #f0f0f0;
    }
  </style>
</head>

<body>

  <h4>Seleciona data</h4>
  <input type="date" id="date" />

  <div id="slots"></div>

  <script>
    let selectedValue = "";

    console.log("âœ… Widget JS carregado");

    // âš ï¸ OBRIGATÃ“RIO
    JFCustomWidget.subscribe("ready", function () {
      console.log("âœ… JFCustomWidget ready");

      // necessÃ¡rio para o iframe nÃ£o ficar minÃºsculo
      JFCustomWidget.requestFrameResize({ height: 300 });
    });

    // quando o user escolhe uma data
    document.getElementById("date").addEventListener("change", function (e) {
      const date = e.target.value;
      const slotsDiv = document.getElementById("slots");
      slotsDiv.innerHTML = "";

      // slots fake (sÃ³ para teste)
      const slots = [
        "09:00â€“09:45",
        "10:00â€“10:45",
        "11:00â€“11:45"
      ];

      slots.forEach(slot => {
        const div = document.createElement("div");
        div.className = "slot";
        div.innerText = slot;

        div.onclick = () => {
          selectedValue = `${date} | ${slot}`;

          console.log("ðŸ“¤ A enviar para Jotform:", selectedValue);

          JFCustomWidget.sendData({
            value: selectedValue
          });

          alert("Selecionado: " + selectedValue);
        };

        slotsDiv.appendChild(div);
      });

      JFCustomWidget.requestFrameResize({ height: 400 });
    });

    // para REQUIRED fields (mesmo que agora nÃ£o uses)
    JFCustomWidget.subscribe("submit", function () {
      JFCustomWidget.sendSubmit({
        valid: selectedValue !== "",
        value: selectedValue
      });
    });
  </script>

</body>
</html>
